# Social Auto Upload å¿«é€Ÿéƒ¨ç½²æŒ‡å—

## ðŸš€ ä¸€é”®éƒ¨ç½²

### 1. å‡†å¤‡æœåŠ¡å™¨
- Ubuntu 20.04+ æˆ– CentOS 7+
- è‡³å°‘ 2GB å†…å­˜ï¼Œ20GB å­˜å‚¨ç©ºé—´
- ç¡®ä¿æœ‰ sudo æƒé™

### 2. è®¾ç½®çŽ¯å¢ƒå˜é‡
```bash
# è®¾ç½®é¡¹ç›®ä»“åº“åœ°å€ï¼ˆæ›¿æ¢ä¸ºä½ çš„ä»“åº“åœ°å€ï¼‰
export REPO_URL=https://github.com/your-username/social-auto-upload.git

# è®¾ç½®åŸŸåï¼ˆå¯é€‰ï¼Œä¸è®¾ç½®å°†ä½¿ç”¨æœåŠ¡å™¨IPï¼‰
export DOMAIN=your-domain.com
```

### 3. ä¸‹è½½å¹¶è¿è¡Œéƒ¨ç½²è„šæœ¬
```bash
# ä¸‹è½½éƒ¨ç½²è„šæœ¬
wget https://raw.githubusercontent.com/your-username/social-auto-upload/main/deploy.sh

# æˆ–è€…å¦‚æžœä½ å·²ç»æœ‰é¡¹ç›®ä»£ç 
chmod +x deploy.sh

# è¿è¡Œéƒ¨ç½²è„šæœ¬
./deploy.sh
```

### 4. ç­‰å¾…éƒ¨ç½²å®Œæˆ
è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆä»¥ä¸‹æ“ä½œï¼š
- âœ… ç³»ç»Ÿæ›´æ–°å’Œä¾èµ–å®‰è£…
- âœ… Python çŽ¯å¢ƒé…ç½®
- âœ… å‰ç«¯æž„å»º
- âœ… æ•°æ®åº“åˆå§‹åŒ–
- âœ… ç³»ç»ŸæœåŠ¡é…ç½®
- âœ… Nginx åå‘ä»£ç†é…ç½®
- âœ… é˜²ç«å¢™è®¾ç½®

## ðŸ“‹ æ‰‹åŠ¨éƒ¨ç½²ï¼ˆå¦‚æžœè‡ªåŠ¨éƒ¨ç½²å¤±è´¥ï¼‰

### ç¬¬ä¸€æ­¥ï¼šç³»ç»ŸçŽ¯å¢ƒ
```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£…åŸºç¡€ä¾èµ–
sudo apt install -y python3 python3-pip python3-venv nodejs npm nginx supervisor git
```

### ç¬¬äºŒæ­¥ï¼šå…‹éš†é¡¹ç›®
```bash
# å…‹éš†é¡¹ç›®åˆ° /var/www
sudo git clone https://github.com/your-username/social-auto-upload.git /var/www/social-auto-upload
cd /var/www/social-auto-upload
sudo chown -R $USER:$USER .
```

### ç¬¬ä¸‰æ­¥ï¼šåŽç«¯é…ç½®
```bash
# åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒ
python3 -m venv venv
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# é…ç½®æ–‡ä»¶
cp conf.example.py conf.py

# åˆå§‹åŒ–æ•°æ®åº“
cd db && python3 createTable.py && cd ..
```

### ç¬¬å››æ­¥ï¼šå‰ç«¯æž„å»º
```bash
cd sau_frontend
npm install
npm run build
cd ..
```

### ç¬¬äº”æ­¥ï¼šç³»ç»ŸæœåŠ¡
```bash
# é…ç½® Supervisor
sudo tee /etc/supervisor/conf.d/sau-backend.conf > /dev/null <<EOF
[program:sau-backend]
command=/var/www/social-auto-upload/venv/bin/python sau_backend.py
directory=/var/www/social-auto-upload
user=www-data
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/sau-backend.log
environment=PATH="/var/www/social-auto-upload/venv/bin"
EOF

# å¯åŠ¨æœåŠ¡
sudo chown -R www-data:www-data /var/www/social-auto-upload
sudo supervisorctl reread && sudo supervisorctl update
sudo supervisorctl start sau-backend
```

### ç¬¬å…­æ­¥ï¼šNginx é…ç½®
```bash
# åˆ›å»º Nginx é…ç½®
sudo tee /etc/nginx/sites-available/social-auto-upload > /dev/null <<EOF
server {
    listen 80;
    server_name your-domain.com;  # æ›¿æ¢ä¸ºä½ çš„åŸŸå

    location / {
        root /var/www/social-auto-upload/sau_frontend/dist;
        try_files \$uri \$uri/ /index.html;
    }

    location ~ ^/(upload|getFile|uploadSave|getFiles|getValidAccounts|deleteFile|deleteAccount|login|postVideo|updateUserinfo|postVideoBatch) {
        proxy_pass http://127.0.0.1:5409;
        proxy_set_header Host \$host;
        proxy_set_header X-Real-IP \$remote_addr;
        proxy_set_header X-Forwarded-For \$proxy_add_x_forwarded_for;
        client_max_body_size 200M;
    }
}
EOF

# å¯ç”¨é…ç½®
sudo ln -s /etc/nginx/sites-available/social-auto-upload /etc/nginx/sites-enabled/
sudo rm -f /etc/nginx/sites-enabled/default
sudo nginx -t && sudo systemctl reload nginx
```

## ðŸ”§ é…ç½® HTTPSï¼ˆæŽ¨èï¼‰

```bash
# å®‰è£… Certbot
sudo apt install certbot python3-certbot-nginx -y

# èŽ·å– SSL è¯ä¹¦
sudo certbot --nginx -d your-domain.com

# è®¾ç½®è‡ªåŠ¨ç»­æœŸ
echo "0 12 * * * /usr/bin/certbot renew --quiet" | sudo crontab -
```

## âœ… éªŒè¯éƒ¨ç½²

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo supervisorctl status sau-backend
sudo systemctl status nginx

# æ£€æŸ¥ç«¯å£
sudo netstat -tlnp | grep -E ":(80|5409) "

# è®¿é—®æµ‹è¯•
curl http://your-domain.com
```

## ðŸ› ï¸ å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹æ—¥å¿—
sudo tail -f /var/log/sau-backend.log

# é‡å¯æœåŠ¡
sudo supervisorctl restart sau-backend
sudo systemctl reload nginx

# æ›´æ–°ä»£ç 
cd /var/www/social-auto-upload
git pull
source venv/bin/activate && pip install -r requirements.txt
cd sau_frontend && npm install && npm run build && cd ..
sudo supervisorctl restart sau-backend
```

## ðŸ†˜ æ•…éšœæŽ’æŸ¥

### åŽç«¯æœåŠ¡æ— æ³•å¯åŠ¨
```bash
# æ£€æŸ¥æ—¥å¿—
sudo tail -f /var/log/sau-backend.log

# æ‰‹åŠ¨å¯åŠ¨æµ‹è¯•
cd /var/www/social-auto-upload
source venv/bin/activate
python sau_backend.py
```

### å‰ç«¯é¡µé¢404
```bash
# æ£€æŸ¥å‰ç«¯æž„å»º
cd /var/www/social-auto-upload/sau_frontend
npm run build

# æ£€æŸ¥ Nginx é…ç½®
sudo nginx -t
sudo systemctl reload nginx
```

### æ•°æ®åº“æƒé™é—®é¢˜
```bash
# è®¾ç½®æƒé™
sudo chown -R www-data:www-data /var/www/social-auto-upload/db/
sudo chmod 664 /var/www/social-auto-upload/db/database.db
```

## ðŸ“ž æ”¯æŒ

å¦‚æžœé‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æ£€æŸ¥ç›¸å…³æœåŠ¡æ—¥å¿—
2. ç¡®è®¤é˜²ç«å¢™å’Œç«¯å£é…ç½®
3. éªŒè¯æ–‡ä»¶æƒé™è®¾ç½®
4. æŸ¥çœ‹ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ

---

**éƒ¨ç½²å®ŒæˆåŽè®¿é—®åœ°å€ï¼š**
- HTTP: `http://your-domain.com`
- HTTPS: `https://your-domain.com` (é…ç½®SSLåŽ) 